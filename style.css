/* --------- Theme Palette --------- */
:root{
  /* UCSD brand colors */
  --ucsd-navy: #182B49;
  --ucsd-gold: #C69214;
  --ucsd-blue: #00C6D7;

  /* Core tokens */
  --color-accent: var(--ucsd-navy);
  --text: oklch(30% 0 0);
  --border: oklch(90% 0.02 200);
  --sep: oklch(80% 0.03 200);

  /* Mixed tints for subtle UI states (modern browsers) */
  --accent-weak-bg: color-mix(in oklab, var(--ucsd-navy) 8%, white);
  --accent-mid-bg:  color-mix(in oklab, var(--ucsd-navy) 18%, white);
  --gold-weak-bg:   color-mix(in oklab, var(--ucsd-gold) 14%, white);
  --gold-mid-bg:    color-mix(in oklab, var(--ucsd-gold) 24%, white);
}

html { accent-color: var(--color-accent); }

/* --------- Baseline / Resets --------- */
*,
*::before,
*::after { box-sizing: border-box; }

body {
  font: 100%/1.5 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  color: var(--text);
  background: white;

  /* Constrain width + center*/
  max-width: 100ch;
  margin-inline: max(1rem, (100% - 100ch) / 2);
  padding-block: 1rem;
}

img, svg, video {
  max-width: 100%;
  height: auto;
  display: block;
}

/* --------- Headings --------- */
h1 {
  font-size: 400%;
  line-height: 1.1;
  text-wrap: balance;
  margin-block: 0.5em 0.3em;
  color:#182B49;
}

h2 {
  line-height: 1.1;
  text-wrap: balance;
  color:#006A96;
}


h1, h2, h3, h4, h5, h6 {
  line-height: 1.1;
  text-wrap: balance;
}

/* --------- Links & Focus Visibility --------- */
a { color: inherit; text-decoration-thickness: .08em; }
a:focus-visible,
button:focus-visible,
input:focus-visible,
textarea:focus-visible,
select:focus-visible {
  outline: 0.2rem solid var(--ucsd-navy);
  outline-offset: 0.1rem;
}

/* --------- Navigation --------- */
/* Works whether nav contains direct <a> or a <ul><li> list */
nav {
  display: flex;
  flex-wrap: wrap;
  gap: 0;
  margin-block-end: 1rem;
  border-bottom: 1px solid var(--sep);
  background: var(--accent-weak-bg);
}

/* Flatten list semantics visually if used */
nav ul, nav li { display: contents; }

/* DEFAULT: UCSD blue links */
nav a {
  flex: 1;
  text-align: center;
  text-decoration: none;
  padding: 0.6em 0.8em;
  color: var(--ucsd-navy);
  border-bottom: 0.4em solid transparent;
}

/* Hover uses UCSD logo gold accent */
nav a:hover {
  border-bottom-color: var(--ucsd-gold);
  background: var(--gold-weak-bg);
}

/* Current page highlight */
nav a[aria-current="page"],
nav a.current {
  border-bottom-color: var(--ucsd-navy);
  background: color-mix(in oklab, var(--ucsd-navy) 6%, white);
  font-weight: 700;
  color: var(--ucsd-navy);
}

/* Keep current state obvious on hover */
nav a[aria-current="page"]:hover,
nav a.current:hover {
  border-bottom-color: var(--ucsd-gold);
  background: color-mix(in oklab, var(--ucsd-navy) 10%, white);
}

/* --------- Forms --------- */
input, textarea, button, select { font: inherit; color: inherit; }

/* Block layout defaults (Step 3.2) */
label, input, textarea, button, select { display: block; }

input, textarea, select {
  width: 100%;
  padding: 0.55em 0.65em;
  border: 1px solid var(--sep);
  border-radius: 0.35rem;
  background: white;
}

textarea { min-height: 8rem; resize: vertical; }

button {
  cursor: pointer;
  border: 1px solid var(--sep);
  border-radius: 0.45rem;
  color: var(--gold-mid-bg);
  background: var(--ucsd-navy);
  padding: 0.6em 0.9em;
}
button:hover { background: var(--ucsd-navy); }

/* Two-column form layout with CSS Grid + subgrid (Step 3.3) */
form {
  display: grid;
  grid-template-columns: auto 1fr; /* label | control */
  gap: 1em;
}

/* Each label spans both columns; its contents align to the subgrid */
label {
  display: grid;
  grid-template-columns: subgrid;
  grid-column: 1 / -1;
  gap: 0.5em;
}

/* Submit button spans full row */
button[type="submit"],
button:not([type]) { grid-column: 1 / -1; }

/* --------- Projects Grid --------- */
.projects {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(15em, 1fr));
  gap: 1em;
}

/* Align headings/images/paragraphs across cards using subgrid rows */
.projects > article {
  display: grid;
  grid-template-rows: auto;
  grid-row: auto;
  height: auto;
  border: 1px solid var(--border);
  border-radius: 0.5rem;
  background: var(--accent-weak-bg);
  padding: 0.9rem;
  transition: transform .12s ease, box-shadow .12s ease, background-color .12s ease;
  color:var(--text);
}
.projects > article:hover {
  background: var(--gold-weak-bg);
  transform: translateY(-1px);
  box-shadow: 0 2px 10px color-mix(in oklab, var(--ucsd-navy) 10%, transparent);
}

.projects h2 { margin: 0 0 0.4rem 0; font-size: 1.1rem; }

.projects > article a.project-link {
  display: grid;
  color: inherit;
  text-decoration: none;
}

.projects > article a.project-link:hover {
  transform: scale(1.02);
  text-decoration: none;
  color: var(--ucsd-gold); 
}


/* --------- Misc Utilities --------- */
hr {
  border: 0;
  border-top: 1px solid var(--border);
  margin-block: 1.5rem;
}

/* Respect reduced motion preferences */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.001ms !important;
    scroll-behavior: auto !important;
  }
}

/* ============================================================
   DARK THEME
   ============================================================ */
html[data-theme="dark"] {
  color-scheme: dark;
  --text: oklch(93% 0 0);
  --border: oklch(30% 0.03 250);
  --sep: oklch(40% 0.03 250);
  --accent-weak-bg: color-mix(in oklab, var(--ucsd-navy) 85%, black);
  --accent-mid-bg: color-mix(in oklab, var(--ucsd-navy) 92%, black);
  --gold-weak-bg: color-mix(in oklab, var(--ucsd-gold) 30%, black);
  --gold-mid-bg: color-mix(in oklab, var(--ucsd-gold) 50%, black);
  background: oklch(14% 0 250);
}

html[data-theme="dark"] body {
  background: oklch(14% 0 250);
  color: var(--text);
}

/* Nav: gold text/underline, navy-tinted background, keep same structure */
html[data-theme="dark"] nav {
  border-bottom: 1px solid var(--sep);
  background: var(--accent-mid-bg);
}
html[data-theme="dark"] nav a {
  color: var(--ucsd-gold);
}
html[data-theme="dark"] nav a:hover {
  border-bottom-color: var(--ucsd-gold);
  background: var(--border);
}
html[data-theme="dark"] nav a[aria-current="page"],
html[data-theme="dark"] nav a.current {
  border-bottom-color: var(--ucsd-gold);
  background: color-mix(in oklab, var(--ucsd-navy) 60%, black);
  color: var(--ucsd-gold);
}
html[data-theme="dark"] nav a[aria-current="page"]:hover,
html[data-theme="dark"] nav a.current:hover {
  border-bottom-color: var(--ucsd-gold);
  background: color-mix(in oklab, var(--ucsd-navy) 45%, black);
}

/* Inputs/buttons/cards adapt without altering layout */
html[data-theme="dark"] input,
html[data-theme="dark"] textarea,
html[data-theme="dark"] select {
  background: oklch(20% 0 250);
  border-color: var(--sep);
  color: var(--text);
}
html[data-theme="dark"] button {
  background: var(--ucsd-gold);
  color: var(--ucsd-navy);
  border-color: var(--ucsd-gold);
}
html[data-theme="dark"] .projects > article {
  background: color-mix(in oklab, var(--ucsd-navy) 55%, #1a1a1a);
  border-color: var(--sep);
}

html[data-theme="dark"] .projects > article:hover {
  background: color-mix(in oklab, var(--ucsd-gold) 20%, var(--ucsd-navy));
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.6);
}

html[data-theme="dark"] .projects > article h2,
html[data-theme="dark"] .projects > article h3 {
  color: var(--text);
}

html[data-theme="dark"] h1 {
  color: var(--ucsd-gold);
}

html[data-theme="dark"] h2 {
  color: var(--ucsd-blue);
}

/* ============================================================
   Theme Switcher UI
   ============================================================ */
.theme-switcher {
  position: fixed;
  top: 0.8rem;
  right: 0.8rem;
  z-index: 2000;
  background: color-mix(in oklab, var(--ucsd-navy) 5%, white);
  border: 1px solid var(--sep);
  border-radius: 0.4rem;
  padding: 0.25rem 0.6rem;
  font: 0.95rem system-ui, sans-serif;
  display: flex;
  align-items: center;
  gap: 0.4rem;
  box-shadow: 0 2px 5px rgb(0 0 0 / 0.1);
}
.theme-switcher label { font-weight: 600; }
.theme-switcher select {
  font: inherit;
  border: 1px solid var(--sep);
  border-radius: 0.3rem;
  background: white;
  padding: 0.15rem 0.4rem;
}

html[data-theme="dark"] .theme-switcher {
  background: color-mix(in oklab, var(--ucsd-navy) 85%, black);
  border-color: var(--sep);
}
html[data-theme="dark"] .theme-switcher select {
  background: color-mix(in oklab, var(--ucsd-navy) 70%, black);
  color: var(--ucsd-gold);
  border-color: var(--sep);
}

/* ============================================================
   LAB 4
   ============================================================ */

/* Container used by new HTML pages (keeps your 100ch body constraint intact) */
.container {
  max-width: 100ch;
  margin-inline: auto;
  padding: 1.25rem;
}

/* Optional header/footer wrappers for the new layout (nav already styled above) */
.site-header { position: sticky; top: 0; background: white; z-index: 10; }
.site-footer {
  border-top: 1px solid var(--border);
  padding: 1rem 1.25rem;
  text-align: center;
  color: color-mix(in oklab, var(--ucsd-navy) 40%, #666);
}

/* Small brand weight utility if you use <a class="brand"> */
.brand { font-weight: 700; }

/* Pills for year badges on project cards */
.pill {
  display: inline-block;
  font-size: .75rem;
  padding: .1rem .5rem;
  border-radius: 999px;
  background: #00C6D7;
  color: white;
  vertical-align: middle;
  margin-left: .35rem;
}

/* Empty-state text for when JSON is missing or fetch fails */
.empty-state { opacity: .8; font-style: italic; }

/* GitHub profile stats block (Home page) */
.profile-stats-section { margin-block: 2rem; }
.profile-stats h3 { margin: 0 0 .5rem 0; }
.profile-stats dl {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: .5rem 1rem;
  margin: 0;
}
.profile-stats dt { grid-row: 1; font-weight: 600; }
.profile-stats dd { grid-row: 2; margin: 0; }

/* Dark theme tweaks for the new helpers */
html[data-theme="dark"] .site-header { background: oklch(14% 0 250); }
html[data-theme="dark"] .site-footer { color: var(--text); border-top-color: var(--sep); }
html[data-theme="dark"] .pill {
  background: var(--ucsd-blue);
  color: var(--ucsd-navy);
}

/* ============================================================
   LAB 5
   ============================================================ */

/* Layout: pie left, legend right */
.pie-and-legend {
  display: grid;
  grid-template-columns: min(22rem, 100%) 1fr;
  gap: 1rem 2rem;
  align-items: start;
  margin-block: 1rem 2rem;
}

/* SVG size & behavior */
#projects-pie-plot {
  max-width: 20em;
  margin-block: 1.25rem;
  overflow: visible;
}

/* Legend pills */
.legend {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(11rem, 1fr));
  gap: .6rem 1rem;
  list-style: none;
  padding: 0;
  margin: 0;
}
.legend li {
  display: flex;
  align-items: center;
  gap: .5rem;
  background: #eef2f6;                 /* light gray like the lab */
  border: 1px solid #d8dee6;
  border-radius: .6rem;
  padding: .5rem .75rem;
  cursor: pointer;
  color: #2b3645;
}
.legend li em {
  font-style: normal;
  opacity: .7;
  margin-left: .25rem;
}
.legend .swatch {
  width: 1rem;
  aspect-ratio: 1 / 1;
  border-radius: .2rem;
  background: var(--color);
  border: 1px solid rgba(0,0,0,.15);
}

/* Remove rectangle focus; use subtle effects that don't change hue */
#projects-pie-plot,
#projects-pie-plot path,
#projects-pie-plot path:focus { outline: none !important; }

#projects-pie-plot .slice {
  transition: transform .15s ease, filter .15s ease, opacity .15s ease;
}

#projects-pie-plot .slice.is-hovered,
#projects-pie-plot .slice.is-selected {
  filter: drop-shadow(0 2px 6px rgba(0,0,0,.25));
  transform: scale(1.03);
}

#projects-pie-plot .slice.dimmed { opacity: .35; }

.legend li.is-hovered,
.legend li.is-selected {
  outline: 2px solid var(--color);
  outline-offset: 2px;
  box-shadow: none;
}

.legend li.dimmed {
  opacity: .5;
  filter: saturate(.7);
}

/* Search input look like the lab */
#project-search {
  max-width: 28rem;
  padding: .6rem .8rem;
  border: 1px solid #d8dee6;
  border-radius: .6rem;
  background: #fff;
}

/* Accessibility helper */
.visually-hidden {
  position: absolute !important;
  clip: rect(1px,1px,1px,1px) !important;
  clip-path: inset(50%) !important;
  height: 1px !important; width: 1px !important;
  overflow: hidden !important; white-space: nowrap !important;
}

/* ===== Lab 6 additions ===== */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(12rem, 1fr));
  gap: .75rem;
  margin: 1rem 0;
}
.stats-grid .card {
  background: var(--accent-weak-bg);
  border: 1px solid var(--border);
  border-radius: .6rem;
  padding: .6rem .8rem;
}
.stats-grid .card em {
  display: block; opacity: .7; margin-top: .2rem;
}
.stats-grid .mini { padding: .5rem .6rem; }

.scatter-controls { display:flex; gap:.5rem; align-items:center; margin:.5rem 0 1rem; }
.pill {
  display:inline-block; padding:.2rem .5rem; border-radius:.6rem;
  background: var(--accent-weak-bg); color: var(--text); border: 1px solid var(--border);
}

#scatter { width: 100%; max-width: 960px; height: 540px;  display: block; background: transparent; }
#scatter .grid line {
  stroke: var(--border); stroke-width: 1; shape-rendering: crispEdges; opacity: .6;
}
#tooltip {
  position: fixed; z-index: 1000;
  background: var(--card); color: var(--text);
  padding: .5rem .6rem; border-radius: .5rem;
  box-shadow: 0 4px 18px rgba(0,0,0,.18);
  border: 1px solid var(--border);
  pointer-events: none;
  font: 12px/1.3 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue";
}
.brush .selection {
  fill: color-mix(in oklab, var(--ucsd-gold) 20%, transparent);
  stroke: var(--ucsd-gold);
  stroke-width: 1.2;
}
